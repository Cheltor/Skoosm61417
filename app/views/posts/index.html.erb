<p id="notice"><%= notice %></p>

<div class="content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="header">
            <h1 class="title">Posts</h1>
            <p class="category">All of the Posts on Skoosm</p>
          </div>
          <%= search_form_for @search, defaults: {wrapper: :inline_field4} do |f| %>
          <div class="well container form-inline">
            <div class="form-group">
              <h2>Search:</h2>
                <%= f.text_field :title_or_content_or_comments_content_cont, placeholder: 'Post contains' %>
                <%= f.submit "Search" %>
            </div>
          </div>
          <% end %>
            <div class="content table-responsive table-full-width">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Title</th>
                    <th>Url</th>
                    <th>Content</th>
                    <th>Course</th>
                    <th>Subject</th>
                    <th>User</th>
                    <th>User Karma</th>
                    <th>Like</th>
                    <td>Dislike</td>
                    <th></th>
                  </tr>
                </thead>

                <tbody>
                  <% @posts.each do |post| %>
                    <tr>
                      <td><%= post.title %></td>
                      <td><%= post.url %></td>
                      <td><%= post.content %></td>
                      <td><%= post.course.name %></td>
                      <td><%= post.course.subject.name %></td>
                      <% if post.user.blank? %>
                          <td>User Deleted</td>
                          <td>N/A</td>
                          <td>N/A</td>
                          <td>N/A</td>
                        <% else %>
                          <td><%= post.user.email %></td>
                          <td><%= post.user.try(:karma) %></td>
                          <td><%= link_to like_post_path(post), method: :put, class: "btn btn-default btn-sm" do %>
                            <span class="ti-arrow-up"></span><% end %>
                            <%= post.get_upvotes.size %></td>
                          <td><%= link_to dislike_post_path(post), method: :put, class: "btn btn-default btn-sm" do %>
                            <span class="ti-arrow-down"></span><% end %><%= post.get_downvotes.size %></td>
                      <% end %>
                      <td><%= link_to 'Show', post, :class => 'btn btn-primary' %></td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<br>

<%= link_to 'New Post', new_post_path %>
